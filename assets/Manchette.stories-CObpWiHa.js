/* empty css              */import{M as v,Z as _,a as w,c as R,g as z,o as $,b as j,I as B,d as T,e as I,S as G}from"./OperationalPoint-C_nQyo4m.js";import{r as n,R as t}from"./index-RYns6xqu.js";import{t as K,Y as V}from"./index.esm-Dk8PHLvH.js";import{V as W,i as X}from"./index.esm-0nN0eK2b.js";import{c as N}from"./index-Cm1LdsEh.js";import{O as q}from"./OperationalPointList-D1aV-sbO.js";import"./lodash-CcdATr5u.js";import"./chroma-CVOSM3bD.js";const F=(o,s)=>{const[i,a]=n.useState(void 0);return n.useLayoutEffect(()=>{const{current:m}=o,r=()=>{if(m){const d=m.scrollHeight>m.clientHeight;a(d),s&&s(d)}};m&&("ResizeObserver"in window&&new ResizeObserver(r).observe(m),r())},[s,o]),i},J=(o,s)=>o.positions.map((i,a)=>({time:o.times[a]+new Date(s).getTime(),position:i})),Q=(o,s)=>n.useMemo(()=>o.map(i=>({id:`${i.id}`,label:i.name,color:s&&s===i.id?"#201EDE":"#000000",points:i.space_time_curves.flatMap(a=>J(a,i.departure_time))})),[o,s]);function U(o,s){return{x:s.x-o.x,y:s.y-o.y}}const ee=({operationalPoints:o,projectPathTrainResult:s,selectedProjection:i})=>{const a=n.useRef(null),[m,r]=n.useState({xZoom:1,yZoom:1,xOffset:0,yOffset:0,panning:null,scrollPosition:0,isProportional:!1,operationalPointsChart:[],operationalPointsToDisplay:[],panY:!1,scales:[]}),{xZoom:d,yZoom:l,xOffset:P,yOffset:M,panY:S,panning:O,scrollPosition:D,isProportional:f,operationalPointsChart:g,operationalPointsToDisplay:A,scales:y}=m,C=Q(s,i),H=n.useCallback(()=>{l<v&&r(e=>({...e,yZoom:l+_}))},[l]),L=n.useCallback(()=>{l>w&&r(e=>({...e,yZoom:l-_}))},[l]),E=n.useCallback(()=>{if(a.current){const{scrollTop:e}=a.current;(e||e===0)&&r(c=>({...c,scrollPosition:e,yOffset:e}))}},[]),Y=n.useCallback(()=>{r(e=>({...e,isProportional:!e.isProportional}))},[]),k=n.useCallback(e=>{r(c=>({...c,panY:e}))},[]);return F(a,k),n.useEffect(()=>(window.addEventListener("scroll",E,{passive:!0}),()=>{window.removeEventListener("scroll",E)}),[E]),n.useEffect(()=>{const e=R(o,f,l);r(c=>({...c,operationalPointsChart:z(e),operationalPointsToDisplay:$(e,l,f)}))},[o,f,l]),n.useEffect(()=>{r(e=>({...e,scales:j(g,f,l)}))},[g]),t.createElement("div",{className:"manchette-space-time-chart-wrapper"},t.createElement("div",{className:"header bg-ambientB-5 w-full border-b border-grey-30",style:{height:"40px"}}),t.createElement("div",{ref:a,className:"manchette flex",onScroll:E},t.createElement("div",{className:"manchette-container "},t.createElement("div",{className:" bg-ambientB-10 border-r border-grey-30",style:{minHeight:`${B}px`}},t.createElement(q,{operationalPoints:A})),t.createElement("div",{className:"manchette-actions flex items-center"},t.createElement("div",{className:" flex items-center "},t.createElement("button",{className:"h-full px-3 w-full zoom-out",onClick:L,disabled:l<=w},t.createElement(K,null))),t.createElement("div",{className:" flex items-center  border-x border-black-25  h-full"},t.createElement("button",{className:"h-full px-3 w-full zoom-in",disabled:l>=v,onClick:H},t.createElement(V,null))),t.createElement("div",{className:"flex items-center ml-auto text-sans font-semibold"},t.createElement("button",{className:"toggle-mode",onClick:Y},t.createElement("div",{className:"flex flex-col items-end pr-2"},t.createElement("span",{className:N({"text-grey-30":!f})},"Km"),t.createElement("span",{className:N({"text-grey-30":f})},"LinÃ©aire")))))),t.createElement("div",{className:"space-time-chart-container w-full sticky",style:{bottom:0,left:0,top:0,height:`${T}px`}},y.length>0&&t.createElement(W,{className:"inset-0 absolute h-full",style:{top:0,height:"calc(100% - 6px)"},operationalPoints:g,spaceOrigin:0,spaceScales:y,timeOrigin:Math.min(...s.map(e=>+new Date(e.departure_time))),timeScale:6e4/d,xOffset:P,yOffset:-D+14,onPan:({initialPosition:e,position:c,isPanning:Z})=>{var x;const h=U(e,c),p={...m};if(!Z)p.panning=null;else if(!O)p.panning={initialOffset:{x:P,y:M}};else{const{initialOffset:b}=O;if(p.xOffset=b.x+h.x,S){const u=b.y-h.y;a.current&&u>=0&&u+T<=((x=a.current)==null?void 0:x.scrollHeight)&&(p.yOffset=u,p.scrollPosition=u,a.current&&a.current.scrollHeight&&(a.current.scrollTop=u))}}r(p)}},C.map((e,c)=>t.createElement(X,{key:e.id,index:c,path:e,color:e.color}))))))},te=G.operational_points??[],oe=I??[],pe={component:ee,title:"Manchette/Manchette",tags:["autodocs"],argTypes:{operationalPoints:{control:{type:"object"}},projectPathTrainResult:{control:{type:"object"}},selectedProjection:{options:[void 0,...I.map(o=>o.id)],control:{type:"select"}}}},ue={args:{operationalPoints:te,projectPathTrainResult:oe,selectedProjection:3}},de=["Default"];export{ue as Default,de as __namedExportsOrder,pe as default};
